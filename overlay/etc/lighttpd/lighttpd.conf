# /etc/lighttpd/lighttpd.conf

server.modules = (
    "mod_cgi",
    "mod_rewrite",
    "mod_redirect"
)

server.document-root = "/www"
cgi.fix-pathinfo = "enable"
server.port = 80
server.username  = "nobody"
server.groupname = "nogroup"

# 静态资源：自动处理 .html, .css, .js, 图片等
mimetype.assign = (
    ".html" => "text/html",
    ".htm"  => "text/html",
    ".css"  => "text/css",
    ".js"   => "application/javascript",
    ".json" => "application/json",
    ".png"  => "image/png",
    ".jpg"  => "image/jpeg",
    ".jpeg" => "image/jpeg",
    ".gif"  => "image/gif",
    ".ico"  => "image/x-icon",
    ".svg"  => "image/svg+xml",
    ".woff" => "font/woff",
    ".woff2"=> "font/woff2",
    ""      => "application/octet-stream"
)

# 动态接口：/home/xxx → main.cgi
url.rewrite-if-not-file = (
    "^/home/(.*)$" => "/cgi-bin/main.cgi/$1"
)
$HTTP["url"] =~ "^/cgi-bin/" {
    cgi.assign = ( "" => "/www/cgi-bin/main.cgi" )
}

$HTTP["url"] == "/" {
    url.redirect = ( "" => "/login.html" )
}

# 性能优化（嵌入式设备）
server.max-keep-alive-requests = 0
server.max-connections = 16